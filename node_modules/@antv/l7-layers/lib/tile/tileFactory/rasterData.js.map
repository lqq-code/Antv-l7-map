{"version":3,"sources":["../../../src/tile/tileFactory/rasterData.ts"],"names":["RasterTiffTile","option","parentLayer","parent","tile","initOptions","opacity","domain","clampHigh","clampLow","rampColors","rampColorsData","mask","rasterdata","data","console","warn","layers","layerIDList","layer","RasterDataLayer","visible","isVisible","source","parser","type","width","height","extent","bboxPolygon","bbox","style","emitEvent","id","TileFactory"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;;AACA;;AACA;;;;;;IAEqBA,c;;;;;AAGnB,0BAAYC,MAAZ,EAAyC;AAAA;;AAAA;AACvC,8BAAMA,MAAN;AADuC;AAEvC,UAAKC,WAAL,GAAmBD,MAAM,CAACE,MAA1B;AAFuC;AAGxC;;;;WAED,oBAAkBC,IAAlB,EAA8BC,WAA9B,EAAiE;AAC/D,UACEC,OADF,GAQID,WARJ,CACEC,OADF;AAAA,UAEEC,MAFF,GAQIF,WARJ,CAEEE,MAFF;AAAA,UAGEC,SAHF,GAQIH,WARJ,CAGEG,SAHF;AAAA,UAIEC,QAJF,GAQIJ,WARJ,CAIEI,QAJF;AAAA,UAKEC,UALF,GAQIL,WARJ,CAKEK,UALF;AAAA,UAMEC,cANF,GAQIN,WARJ,CAMEM,cANF;AAAA,UAOEC,IAPF,GAQIP,WARJ,CAOEO,IAPF;AAUA,UAAMC,UAAU,GAAGT,IAAI,CAACU,IAAxB;;AACA,UAAI,CAACD,UAAU,CAACC,IAAhB,EAAsB;AACpBC,QAAAA,OAAO,CAACC,IAAR,CAAa,wBAAb;AACA,eAAO;AACLC,UAAAA,MAAM,EAAE,EADH;AAELC,UAAAA,WAAW,EAAE;AAFR,SAAP;AAID;;AACD,UAAMC,KAAK,GAAG,IAAIC,wBAAJ,CAAoB;AAChCC,QAAAA,OAAO,EAAEjB,IAAI,CAACkB,SADkB;AAEhCV,QAAAA,IAAI,EAAJA;AAFgC,OAApB,EAIXW,MAJW,CAIJV,UAAU,CAACC,IAJP,EAIa;AACvBU,QAAAA,MAAM,EAAE;AACNC,UAAAA,IAAI,EAAE,QADA;AAENC,UAAAA,KAAK,EAAEb,UAAU,CAACa,KAFZ;AAGNC,UAAAA,MAAM,EAAEd,UAAU,CAACc,MAHb;AAINC,UAAAA,MAAM,EAAExB,IAAI,CAACyB,WAAL,CAAiBC;AAJnB;AADe,OAJb,EAYXC,KAZW,CAYL;AACLzB,QAAAA,OAAO,EAAPA,OADK;AAELC,QAAAA,MAAM,EAANA,MAFK;AAGLC,QAAAA,SAAS,EAATA,SAHK;AAILC,QAAAA,QAAQ,EAARA,QAJK;AAKLC,QAAAA,UAAU,EAAVA,UALK;AAMLC,QAAAA,cAAc,EAAdA;AANK,OAZK,CAAd;AAoBA,WAAKqB,SAAL,CAAe,CAACb,KAAD,CAAf,EAAwB,KAAxB;AAEA,iCAAe,KAAKjB,WAApB,EAAiC,CAACiB,KAAD,CAAjC;AAEA,aAAO;AACLF,QAAAA,MAAM,EAAE,CAACE,KAAD,CADH;AAELD,QAAAA,WAAW,EAAE,CAACC,KAAK,CAACc,EAAP;AAFR,OAAP;AAID;;;EAvDyCC,a","sourcesContent":["import { ILayer, ISubLayerInitOptions } from '@antv/l7-core';\nimport { Tile } from '@antv/l7-utils';\nimport { ITileFactoryOptions } from '../interface';\nimport { registerLayers } from '../utils';\nimport TileFactory from './base';\nimport RasterDataLayer from './rasterDataLayer';\n\nexport default class RasterTiffTile extends TileFactory {\n  public parentLayer: ILayer;\n\n  constructor(option: ITileFactoryOptions) {\n    super(option);\n    this.parentLayer = option.parent;\n  }\n\n  public createTile(tile: Tile, initOptions: ISubLayerInitOptions) {\n    const {\n      opacity,\n      domain,\n      clampHigh,\n      clampLow,\n      rampColors,\n      rampColorsData,\n      mask,\n    } = initOptions;\n\n    const rasterdata = tile.data;\n    if (!rasterdata.data) {\n      console.warn('raster data not exist!');\n      return {\n        layers: [],\n        layerIDList: [],\n      };\n    }\n    const layer = new RasterDataLayer({\n      visible: tile.isVisible,\n      mask,\n    })\n      .source(rasterdata.data, {\n        parser: {\n          type: 'raster',\n          width: rasterdata.width,\n          height: rasterdata.height,\n          extent: tile.bboxPolygon.bbox,\n        },\n      })\n      .style({\n        opacity,\n        domain,\n        clampHigh,\n        clampLow,\n        rampColors,\n        rampColorsData,\n      });\n    this.emitEvent([layer], false);\n\n    registerLayers(this.parentLayer, [layer]);\n\n    return {\n      layers: [layer],\n      layerIDList: [layer.id],\n    };\n  }\n}\n"],"file":"rasterData.js"}